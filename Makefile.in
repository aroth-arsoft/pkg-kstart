# $Id$

CC		= @CC@
CFLAGS		= @CFLAGS@
CPPFLAGS	= -I. @CPPFLAGS@
LDFLAGS		= @LDFLAGS@
# This is pretty Solaris-centric, when we need a static binary 
# elsewhere I'll fix it. 
LD_STATIC_FLAGS = -Xlinker -B -Xlinker static 
LD_DYNAMIC_FLAGS = -Xlinker -B -Xlinker dynamic
LIBS		= @LIBS@
K5LIBS		= @K5LIBS@
K4LIBS          = @K4LIBS@

prefix		= /usr/local
bindir		= $(prefix)/bin

VPATH		= @srcdir@
srcdir		= @srcdir@

POD2MAN		= pod2man
POD_OPTS	= -c 'User Commands' -r 'January, 2002'

all: kstart k5start man

kstart: kstart.o 
	$(CC) $(LDFLAGS) -o kstart kstart.o $(LIBS) $(K4LIBS)

k5start: k5start.o
	$(CC) $(LDFLAGS) -o k5start k5start.o $(LIBS) $(K5LIBS)

k5start.static: k5start.o 
	$(CC) $(LD_FLAGS) -o k5start.static k5start.o $(LD_STATIC_FLAGS) $(K5LIBS) $(LD_DYNAMIC_FLAGS) $(LIBS)

kstart.static: kstart.o 
	$(CC) $(LD_FLAGS) -o kstart.static kstart.o $(LD_STATIC_FLAGS) $(K4LIBS) 	$(LD_DYNAMIC_FLAGS) $(LIBS)

man: kstart.1 k5start.1

kstart.1: kstart.pod
	$(POD2MAN) $(POD_OPTS) kstart.pod > kstart.1

k5start.1: k5start.pod
	$(POD2MAN) $(POD_OPTS) k5start.pod > k5start.1	


install: kstart k5start
	cp kstart $(bindir)/kstart
	cp k5start $(bindir)/k5start 

clean:
	rm -f *.o kstart k5start

distclean: clean
	rm -f Makefile config.cache config.h config.log config.status

maintclean: distclean
	rm -f config.h.in configure
